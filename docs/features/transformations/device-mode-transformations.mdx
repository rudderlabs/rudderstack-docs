---
title: "Transformations in Device Mode"
description: Detailed technical documentation on the setup required while using transformations with device mode destinations.
---

RudderStack's Device Mode Transformations feature enables you to use the powerful User Transformation feature not only for the cloud-mode pipelines but also the device-mode only destinations, e.g., Firebase, Hotjar, etc. using this feature, you'll be able to enrich the event data using your custom logic. Moreover, it provides an easier way to filter events to get rid of the bad data, sample events to reduce costs to some destinations, and many more interesting use cases. To learn more about the use cases you can refer to the <Link to="/features/transformations/#use-case">Use case</Link> section.

<div class="warningBlock">
Only the <Link to="/sources/event-streams/sdks/rudderstack-android-sdk/">Android</Link>, <Link to="/sources/event-streams/sdks/rudderstack-ios-sdk/">iOS</Link>, and <Link to="/sources/event-streams/sdks/rudderstack-javascript-sdk/">JavaScript</Link>  SDKs support the Transformations feature to send events to the <Link to="/destinations/rudderstack-connection-modes/#device-mode">device mode</Link> destinations.
</div>

<GhBadge
  url={'https://rudderstack.com/enterprise-quote'}
  label={'Plan'}
  message={'Enterprise'}
  color={'blueviolet'}
/>
<GhBadge
  label={'Stability'}
  message={'Beta'}
  color={'blueviolet'}
  logo={'github'}
/>

## Device-Mode Transformation server Architecture

RudderStack has introduced the Client Transformation service to facilitate the transformation feature for device-mode destinations. This ensures that the even ingestion to RudderStack backend isn't affected, assuring minimum response time from the RudderStack backend.

<img src="../../assets/features/device-mode-transformations-workflow.png" alt="Transformations workflow" />

When you <Link to="#adding-a-transformation">add a transformation</Link> and connect it to a destination supporting the <Link to="/destinations/rudderstack-connection-modes/#device-mode">device mode</Link>, the following steps take place under the hood.

1. RudderStack SDK sends the event to the Client Transformation service to multiplex the event for different destinations and connect with the transformations attached to those device-mode destinations.
2. Client Transformation service reuses our Transformation service to transform the event according to the functions attached to the destinations.
3. After the transformation, the transformed event is returned to the Client Transformation service.
4. Client Transformation service responds to the SDK with the transformed events for all the destinations.
5. Finally, the SDK parses the transformed events and forwards them to the device-mode destinations.

<div class="infoBlock">
Refer to the <Link to="/features/transformations/#use-case">Use case</Link> section to know more about how to accomplish a task using a transformation.
</div>

## SDK setup

After <Link to="#adding-a-transformation">adding a transformation</Link> and <Link to="/features/transformations/#connecting-transformation-to-a-destination">connecting it to a destination</Link> supporting the device mode, you can connect your SDK source to it.

Further, follow the below steps for setting up the required SDK:

<Tabs>
  <TabList>
    <Tab>JavaScript</Tab>
    <Tab>Android</Tab>
    <Tab>iOS</Tab>
  </TabList>
    <TabPanels>
      <TabPanel>

The detailed steps to setup the JavaScript SDK are mentioned in the <Link to="/sources/event-streams/sdks/rudderstack-javascript-sdk/quick-start-guide/">Quickstart guide</Link>. You need to change the CDN URL in the SDK installation snippet to: <code class="inline-code">https://cdn.rudderlabs.com/v1.1/beta/dmt/v1/rudder-analytics.min.js</code>

Alternatively, you can use the following snippet with the updated URL:

<span>

```javascript
<script type="text/javascript">
!function(){var e=window.rudderanalytics=window.rudderanalytics||[];e.methods=["load","page","track","identify","alias","group","ready","reset","getAnonymousId","setAnonymousId","getUserId","getUserTraits","getGroupId","getGroupTraits"],e.factory=function(t){return function(){var r=Array.prototype.slice.call(arguments);return r.unshift(t),e.push(r),e}};for(var t=0;t<e.methods.length;t++){var r=e.methods[t];e[r]=e.factory(r)}e.loadJS=function(e,t){var r=document.createElement("script");r.type="text/javascript",r.async=!0,r.src="https://cdn.rudderlabs.com/v1.1/beta/dmt/v1/rudder-analytics.min.js";var a=document.getElementsByTagName("script")[0];a.parentNode.insertBefore(r,a)},e.loadJS(),
e.load(<WRITE_KEY>,<DATA_PLANE_URL>),
e.page()}();
</script>
```
</span>

</TabPanel>
<TabPanel>

<div class="infoBlock">
Device mode transformations are supported in <strong>Android SDK v1.8.0 and above</strong>.
</div>

Install the Android SDK following the detailed steps mentioned in <Link to="/sources/event-streams/sdks/rudderstack-android-sdk/#installing-the-sdk">Installing the Android SDK</Link> section. Additionally, use the following dependency in the Android app level <code class="inline-code">build.gradle</code>:
<span>

```groovy
implementation 'com.rudderstack.android.sdk:core:1.8.0-beta.1'
```
</span>
    </TabPanel>
<TabPanel>

<div class="infoBlock">
Device mode transformations are supported in <strong>iOS SDK v1.8.0 and above</strong>.
</div>

Install the iOS SDK following the detailed steps mentioned in <Link to="/sources/event-streams/sdks/rudderstack-ios-sdk/#installing-the-rudderstack-ios-sdk">Installing the iOS SDK</Link> section. Additionally, use the following dependency in <code class="inline-code">Podfile</code>:
<span>

```ruby
pod 'Rudder', '1.8.0.beta.1'
```
</span>
      </TabPanel>
    </TabPanels>
</Tabs>

## Limitations

The following limitations are applicable when invoking a transformation in the device mode:

- The network unavailability can lead to higher latency than expected while sending the events to the destinations. RudderStack doesn't lose data due to the loss of the network. We store the events in the client device until those are successfully delivered to the destination.

- The iOS SDK does not support the background processing of an event when the app is closed. However, the pending events are sent the next time the app is opened.

- The following memory and time limits must be followed:

    | Parameter    | Limit     |
    | :----------- | :-------- |
    | Memory limit | 128 MB      |
    | Execution time limit   | 4 seconds |

