---
title: "PHP"
description: Use RudderStackâ€™s PHP SDK to send your server-side events to various destinations.
---

RudderStack's PHP SDK lets you track and send the events from your PHP applications to the specified destinations.

<div class="infoBlock">
Refer to the PHP SDK's <a href="https://github.com/rudderlabs/rudder-php-sdk">GitHub codebase</a> for the implementation-specific details.
</div>

<GhBadge
  url={'https://packagist.org/packages/rudderstack/rudder-php-sdk'}
  repo={'packagist/v/rudderstack/rudder-php-sdk'}
  style={'flat'}
/>

<div class="infoBlock">
RudderStack's PHP SDK supports PHP version 7.4 and above.
</div>

## SDK setup requirements

1. Sign up to [RudderStack Cloud](https://app.rudderstack.com/signup).
2. <Link to="/dashboard-guides/sources/#adding-a-source">Set up a PHP source</Link> in your dashboard. You should be able to see the <strong>write key</strong> for this source, as shown:

<img src="../../../assets/event-stream-sources/php-write-key-new.png" alt="PHP source write key" />

You will also need the data plane URL. Refer to the <Link to="/resources/glossary/#data-plane-url">Glossary</Link> for more information on the data plane URL and where to find it.

<div class="successBlock">
The <strong>Setup</strong> tab in the RudderStack dashboard (seen above) has the SDK installation snippet containing both the write key and the data plane URL. Copy it to integrate the PHP SDK into your application.
</div>

## Installing the PHP SDK

Install the RudderStack PHP SDK using the [**composer**](https://packagist.org/packages/rudderstack/rudder-php-sdk). You can also do so by running the following command:

```bash
git clone https://github.com/rudderlabs/rudder-php-sdk /my/app/folders/
```

Then, use the composer to install the PHP SDK by running the following command:

```bash
composer require rudderstack/rudder-php-sdk
```

## Initializing the RudderStack client

To initialize the RudderStack client, run the following code snippet:

```php
use Rudder\Rudder;

require_once realpath(__DIR__ . '/vendor/autoload.php');

Rudder::init(WRITE_KEY, array(
  "data_plane_url" => DATA_PLANE_URL,
  "consumer"       => "lib_curl",
  "debug"          => false,
  "max_queue_size" => 10000,
  "flush_at"       => 100,
  "ssl"            => true
));
```

<div class="infoBlock">
RudderStack accepts the <code class="inline-code">DATA_PLANE_URL</code> with or without the protocol. If the protocol is missing, RudderStack automatically prepends it to the URL based on whether the <code class="inline-code">ssl</code> option is set to <code class="inline-code">true</code> or  <code class="inline-code">false</code>.
</div>

RudderStack accepts the following data plane URL formats:

| **SSL** | **Data Plane URL**              |
| :------ | :------------------------------ |
| `true`  | `https://example.dataplane.com` |
| `true`  | `example.dataplane.com`         |
| `false` | `http://example.dataplane.com`  |
| `false` | `example.dataplane.com`         |

<div class="warningBlock">
While initializing the RudderStack client, the <code class="inline-code">ssl</code> field is optional if you are using the HTTPS protocol. If included, its value must be set to <code class="inline-code">true</code>. In case of the HTTP protocol, <code class="inline-code">ssl</code> is a required field and must always be set to <code class="inline-code">false</code>.
</div>

### Other initialization options

RudderStack provides some additional initialization options which are explained in the following table:

| Option        | Data type         | Description     |
| :----------- | :--------------- | :----------|
|  `consumer`           | String      | Explicitly marks which consumer to use. The default value is `lib_curl`. Refer to the <Link to="#consumers">Consumers</Link> section for more information. |
|  `data_plane_url `       | String | Explicitly sets the URL to data plane. The default value is `hosted.rudderlabs.com`.  |
|  `debug`          | Boolean  |  Determines whether to log messages and wait for a response. The default value is `false`. It makes the queuing consumers non-async and blocks the library until a response is received from the API. Hence it is **not recommended** for production use.  |
|  `ssl`           | Boolean      | Determines whether to use TLS instead of SSL for the socket connection. The default value is `false`. |
|  `error_handler`       | Function | Function to handle errors and is particularly useful for debugging. Note that if the debug mode is not specified, then the `error_handler` is only called on connection level errors and timeouts. For example, `function ($code, $message) {}`   |
|  `max_queue_size`           | Number      | Max size of the queue. The default value is 10000 items. |
|  `batch_size`       | Number | Items to be sent in a single curl request. The default value is 100. It is recommended to use `flush_at` instead of `batch_size` as it is deprecated.   |
|  `flush_at`           | Number      | Items to be sent in a single curl request. The default value is 100. |
|  `timeout `       | Number | Number of seconds to wait for the socket request to time out. The default value is 0.5.  |
|  `filename`           | String      |Location to write the log file. The default value is `/tmp/analytics.log` when file consumer is selected. |
|  `compress_request`       | Boolean | Determines whether to use gzipped request payloads. The default value is `true`. It is supported for server versions 1.4.0 and above.  |
|  `flush_interval`           | Number      | Frequency in milliseconds to send data using flush method execution. The default value is 10000 miliseconds. |
|  `curl_timeout `       | Number | Timeout for the curl connections. The default value is 0, meaning infinite. |
|  `curl_connecttimeout`           | Number      | Connect timeout for the curl connections. The default value is 300. |
|  `max_item_size_bytes`       | Number | Maximum message item size. The default value is 32000 bytes (32kb). |
|  `max_queue_size_bytes`           | Number      | Maximum batch size. The default value is 512000 bytes (512kb).   |
|  `filepermissions `       | String | File permissions for file consumer. The default value is 0644.   |

## Migrating from v1 to v2

To migrate to PHP SDK v2, ensure the following points:

- Your PHP version should be v7.4 or above.
- If you are using self hosted <a href="https://github.com/rudderlabs/rudder-server">rudder-server</a>, either upgrade it to v1.4.0/above or turn off the gzipped request payloads  (by setting `compress_request` to `false`).

## Sending events from the RudderStack client

Once the RudderStack client is initialized, you can use it to send relevant customer events. 

<div class="warningBlock">

RudderStack does not store the user state in any of the server-side SDKs. Unlike the client-side SDKs that deal with only a single user at a given time, the server-side SDKs deal with multiple users at the same time. Therefore, for any of the calls supported by the PHP SDK, you need to specify either `userId` or `anonymousId` every time.
</div>

A sample `track` call is shown in the following code snippet:

```php
Rudder::track(array(
  "userId" => "f4ca124298",
  "event" => "Signed Up",
  "properties" => array(
    "plan" => "Enterprise"
  )
));
```

## Identify

The `identify` call lets you identify a visiting user and capture any related information such as their name, email address, etc.

A sample `identify` call is as shown:

```php
Rudder::identify(array(
  "userId" => "2sfjej334",
  "traits" => array(
    "email" => "test@test.com",
    "name" => "test name",
    "friends" => 25
  )
));
```

The `identify` method parameters are as described below:

| **Field**      | **Type** | **Presence**                              | **Description**                                                                                                            |
| :------------- | :------- | :---------------------------------------- | :------------------------------------------------------------------------------------------------------------------------- |
| `anonymousId`  | String   | Optional                                  | Sets the user ID for cases where there is no unique identifier for the user. Either `userId` or `anonymousId` is required. |
| `userId`       | String   | Optional, if `anonymousId` is already set | Unique identifier for a particular user in your database.                                                                  |
| `context`      | Object   | Optional                                  | Dictionary of information that provides context about a message. However, it is not directly related to the API call.      |
| `integrations` | Object   | Optional                                  | A dictionary containing the destinations to be either enabled or disabled.                                                 |
| `timestamp`    | Date     | Optional                                  | The timestamp of the message's arrival.                                                                                    |
| `traits`       | Object   | Optional                                  | Dictionary of the traits associated with the user, such as `name`or `email`                                                |

## Track

The `track` call lets you record the user actions along with their associated properties. Each user action is called an **event**.

A sample `track` call is shown below:

```php
Rudder::track(array(
  "userId" => "f4ca124298",
  "event" => "Article Bookmarked",
  "properties" => array(
    "title" => "Snow Fall",
    "subtitle" => "The Avalanche at Tunnel Creek",
    "author" => "John Branch"
  )
));
```

The `track` method parameters are as described below:

| Name           | Type   | Presence | Description                                                                                                                |
| :------------- | :----- | :------- | :------------------------------------------------------------------------------------------------------------------------- |
| `user_id`      | String | Required | The developer identification for your user                                                                                 |
| `event`        | String | Required | Name of the event being performed by the user                                                                              |
| `properties`   | Object | Optional | Dictionary of the properties associated with a particular event.                                                           |
| `context`      | Object | Optional | Dictionary of information that provides context about a message. However, it is not directly related to the API call.      |
| `timestamp`    | Date   | Optional | The timestamp of the message's arrival.                                                                                    |
| `anonymous_id` | String | Optional | Sets the user ID for cases where there is no unique identifier for the user. Either `userId` or `anonymousId` is required. |
| `integrations` | Object | Optional | A dictionary containing the destinations to be either enabled or disabled.                                                 |

## Page

The `page` call allows you to record the page views on your website along with the other relevant information about the viewed page.

A sample `page` call is as shown:

```php
Rudder::page(array(
  "userId" => "f4ca124298",
  "category" => "Docs",
  "name" => "PHP library",
  "properties" => array(
    "url" => "https://segment.com/libraries/php/"
  )
));
```

The `page` method parameters are as described below:

| **Field**      | **Type** | **Presence**                              | **Description**                                                                                                            |
| :------------- | :------- | :---------------------------------------- | :------------------------------------------------------------------------------------------------------------------------- |
| `anonymousId`  | String   | Optional                                  | Sets the user ID for cases where there is no unique identifier for the user. Either `userId` or `anonymousId` is required. |
| `userId`       | String   | Optional, if `anonymousId` is already set | Unique identifier for a particular user in your database.                                                                  |
| `context`      | Object   | Optional                                  | Dictionary of information that provides context about a message. However, it is not directly related to the API call.      |
| `integrations` | Object   | Optional                                  | A dictionary containing the destinations to be either enabled or disabled.                                                 |
| `name`         | String   | Required                                  | Name of the page being viewed.                                                                                             |
| `properties`   | Object   | Optional                                  | Dictionary of the properties associated with the page being viewed, such as `url` and `referrer`                           |
| `timestamp`    | Date     | Optional                                  | The timestamp of the message's arrival.                                                                                    |

## Screen

The `screen` call is the mobile equivalent of the `page` call. It allows you to record the screen views on your mobile app along with the other relevant information about the app screen.

A sample `screen` call is as shown:

```php
Rudder::screen(array(
  "userId" => "f4ca124298",
  "category" => "Docs",
  "name" => "PHP library",
  "properties" => array(
    "name" => "HomeScreen"
  )
));
```

The `screen` method parameters are as described below:

| **Field**      | **Type** | **Presence**                              | **Description**                                                                                                            |
| :------------- | :------- | :---------------------------------------- | :------------------------------------------------------------------------------------------------------------------------- |
| `anonymousId`  | String   | Optional                                  | Sets the user ID for cases where there is no unique identifier for the user. Either `userId` or `anonymousId` is required. |
| `userId`       | String   | Optional, if `anonymousId` is already set | Unique identifier for a particular user in your database.                                                                  |
| `context`      | Object   | Optional                                  | Dictionary of information that provides context about a message. However, it is not directly related to the API call.      |
| `integrations` | Object   | Optional                                  | A dictionary containing the destinations to be either enabled or disabled.                                                 |
| `name`         | String   | Required                                  | Name of the screen being viewed.                                                                                           |
| `properties`   | Object   | Optional                                  | Dictionary of the properties associated with the page being viewed, such as `url` and `referrer`                           |
| `timestamp`    | Date     | Optional                                  | The timestamp of the message's arrival.                                                                                    |

## Group

The `group` call lets you associate an identified user to a group - either a company, project or a team and record any custom traits or properties associated with that group.

A sample `group` call is as shown:

```php
Rudder::group(array(
  "userId" => "2sfjej334",
  "groupId" => "2sfjej334erresd",
  "traits" => array(
    "email" => "test@test.com",
    "name" => "test name",
    "friends" => 25
  )
));
```

The `group` method parameters are as follows:

| **Field**      | **Type** | **Presence**                              | **Description**                                                                                                            |
| :------------- | :------- | :---------------------------------------- | :------------------------------------------------------------------------------------------------------------------------- |
| `anonymousId`  | String   | Optional                                  | Sets the user ID for cases where there is no unique identifier for the user. Either `userId` or `anonymousId` is required. |
| `userId`       | String   | Optional, if `anonymousId` is already set | Unique identifier for a particular user in your database.                                                                  |
| `context`      | Object   | Optional                                  | Dictionary of information that provides context about a message. However, it is not directly related to the API call.      |
| `integrations` | Object   | Optional                                  | A dictionary containing the destinations to be either enabled or disabled.                                                 |
| `groupId`      | String   | Required                                  | Unique identifier of the group, as present in your database.                                                               |
| `traits`       | Object   | Optional                                  | Dictionary of the properties or traits associated with the group, such as `email` or `name`.                               |
| `timestamp`    | Date     | Optional                                  | The timestamp of the message's arrival.                                                                                    |

## Alias

The `alias` call allows you to associate one identity with another.

<div class="infoBlock">

<code class="inline-code">alias</code> is an advanced method that lets you change the tracked user's ID explicitly. This method is useful when managing user identities for some of the downstream destinations.
</div>

A sample `alias` call is as shown:

```php
Rudder::alias(array(
  "previousId" => "previousId",
  "userId" => "2sfjej334",
));
```

The `alias` method parameters are as mentioned below:

| **Field**      | **Type** | **Presence**                              | **Description**                                                                                                       |
| :------------- | :------- | :---------------------------------------- | :-------------------------------------------------------------------------------------------------------------------- |
| `userId`       | String   | Optional, if `anonymousId` is already set | Unique identifier for a particular user in your database.                                                             |
| `context`      | Object   | Optional                                  | Dictionary of information that provides context about a message. However, it is not directly related to the API call. |
| `integrations` | Object   | Optional                                  | A dictionary containing the destinations to be either enabled or disabled.                                            |
| `previousId`   | String   | Required                                  | The previous unique identifier of the user.                                                                           |
| `traits`       | Object   | Optional                                  | Dictionary of the properties or traits associated with the group, such as `email` or `name`.                          |
| `timestamp`    | Date     | Optional                                  | The timestamp of the message's arrival.                                                                               |

<div class="infoBlock">

For a detailed explanation of the <code class="inline-code">alias</code> call, refer to our <a href="https://rudderstack.com/docs/event-spec/standard-events/alias">RudderStack API Specification</a> guide.
</div>

## Consumers

You can specify different consumers to make requests to RudderStack servers as explained below:

### Lib-Curl Consumer

The [lib-curl consumer](https://github.com/rudderlabs/rudder-php-sdk/blob/develop/lib/Consumer/LibCurl.php) is RudderStack's default PHP library. You can use it for faster response during light loads. It runs synchronously, queuing calls and sending them in batches to RudderStack's servers. 

### Fork-Curl Consumer

The [fork-curl consumer](https://github.com/rudderlabs/rudder-php-sdk/blob/develop/lib/Consumer/ForkCurl.php) can be used when you can't use persistent sockets or want to ensure quick response for lighter loads. It creates an in-memory queue which buffers the `identify` and `track` calls. The queue is flushed by forking an async `curl` process that sends a batch request. It happens after every `100` calls or at the end of serving the page, by default. 

### Socket Consumer

You can use the [socket consumer](https://github.com/rudderlabs/rudder-php-sdk/blob/develop/lib/Consumer/Socket.php) which lets you to make requests to RudderStack when you can't spawn other processes from your PHP scripts. It initiates  a socket request to RudderStack servers each time an `identify` or `track` call is made. The socket request writes the event data and closes the connection before waiting for a response. If your servers are dealing with more than 100's of requests per second or cannot use a persistent connection, you may want to use some other consumer.

### File Consumer

You can also use the [file consumer](https://github.com/rudderlabs/rudder-php-sdk/blob/develop/lib/Consumer/File.php) for making requests to RudderStack. It records each `identify` or `track` call you make to a log file. Further, it uploads the log file by running the `file.php` file in RudderStack's [github repository](https://github.com/rudderlabs/rudder-php-sdk/blob/develop/lib/Consumer/File.php).

You can run the `send.php` file to upload your log file to RudderStack, as shown:

```bash
php send.php --secret YOUR_WRITE_KEY --file /tmp/analytics.log
```

<div class="infoBlock">
It is recommended to run this command as a cron job after every few minutes so that your log files are created in manageable sizes. Every time you run the command, it will remove the old log files once they are processed successfully.
</div>

You can create a new cron job to upload your log files. A sample snippet to create a cron job is shown:

```bash
$ # create a cron job that runs as www-data every minute
$ echo '*/1 * * * * www-data php /my/path/to/analytics-php/send.php > /dev/null' | sudo tee /etc/cron.d/analytics
$ sudo service cron reload    # reload the cron daemon
```